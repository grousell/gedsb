---
title: Title
subtitle: Sub Title
author:
  - name: Not used
editor: source
format:
  pdf:
    documentclass: scrbook
    pdf-engine: xelatex
    classoption: ["oneside", "open=any"]
    number-sections: false
    include-in-header: 
      - "in-header.tex"
    title-bg-image: "images/LearnLeadInspire_FullLogo.png"
    title-bg-location: "UL"
    title-bg-size: 0.25
params: 
  session: i
execute: 
  echo: false
  warning: false
---

```{=tex}
\thispagestyle{empty}
\rhead{\bfseries `r rmarkdown::metadata$title`}
```

```{r setup, include=FALSE}

source("01_clean_analyse_data.R")
```

::: {.cols data-latex=""}
::: {.col data-latex="{0.3\\textwidth}"}
![](images/LearnLeadInspire_FullLogo.png){width="140"}
:::

::: {.col data-latex="{0.05\\textwidth}"}
Â  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.6\\textwidth}"}
# `r rmarkdown::metadata$title`
## `r rmarkdown::metadata$subtitle`
:::
:::

In total there were `r n_registrants` staff that participated in a Summer Institute session. Of these, `r n_responses` people responded to the evaluation survey, for a `r resp_rate`% response rate. The table below shows the response rate by session. 

```{r echo=FALSE, warning=FALSE}
responses |> 
  flextable() |> 
  theme_vanilla() |> 
  width (1, 4) |> 
  align (j = 2:4, align = "center", part = "all") 
  
  
```

\newpage
## Participant's Goals

```{r results='asis'}

for (i in unique(goal$Session)){
  
  new_name <- glue ("Goals - {i}")
  
  temp <- goal |> 
    dplyr::filter (Session == i) |> 
    select (Goal) |> 
    rename_with(~new_name, Goal) |> 
    flextable() |> 
    theme_vanilla() |>
    width (1, 6)  |> 
    bg(bg = gedsbBlue2, part = "header")
  
  cat (knitr::knit_print(temp))
  }


```

\newpage
## Participant's Skill Level

```{r}
Q3 |> 
  flextable () |> 
  theme_vanilla() |> 
  width (1, 3) |> 
  width(2:4, 1) |> 
  align (j = 2:4, align = "center", part = "all") |> 
  bg(bg = gedsbBlue2, part = "header")
  
```

\newpage
## In regards to the session, the content presented:
Percentage of respondents that indicated 4, or 5 - Significantly. 

```{r}
colourer <- col_numeric(
    palette = c(gedsbOrange2, gedsbBlue3),
    domain = c(0, 1)
  )

Q4 |> 
  flextable() |> 
  theme_vanilla() |> 
  width (1, 3) |> 
  width (2:6, 0.8) |> 
  align (j = 2:6, align = "center", part = "all") |> 
  bg(j = 3:6, 
     part = "body", 
     bg = colourer) |> 
  set_formatter(`Is USEFUL to me` = function(x) sprintf( "%.1f%%", x*100 )) |> 
  set_formatter(`Is APPLICABLE to my job` = function(x) sprintf( "%.1f%%", x*100 ) ) |> 
  set_formatter(`Has CHANGED by thinking` = function(x) sprintf( "%.1f%%", x*100 ) ) |> 
  set_formatter(`Has REINFORCED my thinking` = function(x) sprintf( "%.1f%%", x*100 ) )

  
```

\newpage
## List at least one thing you learned today that you will use in your classroom or program

```{r results='asis'}

for (i in unique(Q5$Session)){
  
  new_name <- glue ("One thing learned today - {i}")
  
  temp <- Q5 |> 
    dplyr::filter (Session == i) |> 
    select (`One thing you learned today:`) |> 
    rename_with(~new_name, `One thing you learned today:`) |> 
    flextable() |> 
    theme_vanilla() |>
    width (1, 6)  |> 
    bg(bg = gedsbBlue2, part = "header")
  
  cat (knitr::knit_print(temp))
  }


```

\newpage
## Concerning the content of the session, how much of the following has increased?
Percentage of respondents that indicated 4, or 5 - Significantly. 

```{r}
colourer <- col_numeric(
    palette = c(gedsbOrange2, gedsbBlue3),
    domain = c(0, 1)
  )

Q6 |> 
  flextable() |> 
  theme_vanilla() |> 
  width (1, 3) |> 
  width (2:5, 1) |> 
  align (j = 2:5, align = "center", part = "all") |> 
  bg(j = 3:5, 
     part = "body", 
     bg = colourer) |> 
  set_formatter(`KNOWLEDGE of content presented` = function(x) sprintf( "%.1f%%", x*100 )) |> 
  set_formatter(`CONFIDENCE that you can apply the knowledge in your job` = function(x) sprintf( "%.1f%%", x*100 ) ) |> 
  set_formatter(`MOTIVATION to implement the content/techniques presented` = function(x) sprintf( "%.1f%%", x*100 ) ) 

  
```

\newpage
## Please rate your understanding of the topic presented:

Percentage of respondents that indicated 4, or 5 - A Great Deal

```{r}
Q7 |> 
  flextable() |> 
  theme_vanilla() |> 
  width (1, 3) |> 
  width (2:4, 1) |> 
  align (j = 2:4, align = "center", part = "all") |> 
  bg(j = 3:4, 
     part = "body", 
     bg = colourer) |> 
  set_formatter(`BEFORE attending the session` = function(x) sprintf( "%.1f%%", x*100 )) |> 
  set_formatter(`AFTER attending the session` = function(x) sprintf( "%.1f%%", x*100 ))  

  
```

\newpage
## Please rate the timing of the Summer Institute session
Percentage of respondents that indicated 4, or 5 - Excellent

```{r}
Q8 |> 
  flextable() |> 
  theme_vanilla() |> 
  width (1, 3) |> 
  width (2:3, 1) |> 
  align (j = 2:3, align = "center", part = "all") |> 
  bg(j = 3, 
     part = "body", 
     bg = colourer) |> 
  set_formatter(Timing = function(x) sprintf( "%.1f%%", x*100 )) 

  
```

### You indicated that the timing of the sessions was not ideal. When would be a better time to host the sessions?

```{r}
Q9 |> 
  select (`Better time to host the sessions?` = Q9) |> 
  flextable() |> 
  theme_vanilla() |> 
  width (1, 6)  
  
```

\newpage
## Please provide any additional feedback:

```{r results='asis'}

for (i in unique(Q10$Session)){
  
  new_name <- glue ("Additional Feedback - {i}")
  
  temp <- Q10 |> 
    dplyr::filter (Session == i) |> 
    select (Q10) |> 
    rename_with(~new_name, Q10) |> 
    flextable() |> 
    theme_vanilla() |>
    width (1, 6)  |> 
    bg(bg = gedsbBlue2, part = "header")
  
  cat (knitr::knit_print(temp))
  }


```
